<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Windows 2000 Style Mini Web OS</title>

  <!-- CodeMirror CSS -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.css"
  />
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/theme/default.min.css"
  />

  <style>
    /* Windows 2000 style colors */
    :root {
      --win2k-blue: #0a3d62;
      --win2k-gray-light: #c0c0c0;
      --win2k-gray-dark: #808080;
      --win2k-white: #ffffff;
      --win2k-taskbar-bg: #000080;
      --win2k-window-bg: #ffffff;
      --win2k-window-header-bg: #000080;
      --win2k-window-header-text: #ffffff;
      --win2k-taskbar-text: #ffffff;
    }

    * {
      box-sizing: border-box;
    }
    body, html {
      margin: 0;
      height: 100%;
      font-family: 'Tahoma', 'Verdana', 'Segoe UI', sans-serif;
      background: #0078d7;
      color: var(--win2k-window-header-text);
      user-select: none;
      overflow: hidden;
    }

    #desktop {
      height: calc(100vh - 40px);
      padding: 20px;
      display: flex;
      flex-wrap: wrap;
      align-content: flex-start;
      gap: 20px;
      margin-bottom: 40px;

      background: url('https://upload.wikimedia.org/wikipedia/en/2/24/Windows_2000_Bliss_wallpaper.png') no-repeat center center fixed;
      background-size: cover;
    }

    .icon {
      width: 80px;
      cursor: pointer;
      text-align: center;
      color: black;
      font-size: 28px;
      line-height: 1.2;
      user-select: none;
      transition: background-color 0.15s ease;
      padding: 8px;
      border-radius: 4px;
    }
    .icon:hover {
      background-color: var(--win2k-gray-light);
      color: var(--win2k-blue);
    }

    #taskbar {
      position: fixed;
      bottom: 0; left: 0; right: 0;
      height: 40px;
      background: var(--win2k-taskbar-bg);
      color: var(--win2k-taskbar-text);
      display: flex;
      align-items: center;
      padding: 0 10px;
      box-shadow: inset 0 1px 0 #4c6ef5;
      user-select: none;
      font-weight: bold;
      font-size: 14px;
      z-index: 9999;
    }

    .taskbar-btn {
      background: var(--win2k-gray-light);
      border: 2px solid var(--win2k-gray-dark);
      color: var(--win2k-blue);
      margin-right: 8px;
      padding: 4px 10px;
      border-radius: 0;
      cursor: pointer;
      display: flex;
      align-items: center;
      position: relative;
      font-weight: normal;
      font-size: 13px;
      user-select: none;
    }
    .taskbar-btn:hover {
      background: var(--win2k-gray-dark);
      color: var(--win2k-white);
      border-color: var(--win2k-white);
      box-shadow: none;
    }
    .taskbar-close {
      background: var(--win2k-gray-light);
      border: 2px solid var(--win2k-gray-dark);
      color: var(--win2k-blue);
      font-weight: bold;
      padding: 0 5px;
      margin-left: 6px;
      cursor: pointer;
      user-select: none;
      font-size: 14px;
      line-height: 1;
      height: 20px;
      align-self: center;
    }
    .taskbar-close:hover {
      background: var(--win2k-blue);
      color: var(--win2k-white);
      border-color: var(--win2k-white);
      box-shadow: none;
    }

    .window {
      position: fixed;
      top: 100px;
      left: 100px;
      width: 600px;
      height: 400px;
      background: var(--win2k-window-bg);
      border: 2px solid var(--win2k-gray-dark);
      box-shadow:
        2px 2px 0 var(--win2k-gray-light),
        4px 4px 0 var(--win2k-gray-dark);
      display: flex;
      flex-direction: column;
      color: black;
      font-size: 14px;
      user-select: text;
      overflow: hidden;
      z-index: 100;
      border-radius: 0;
    }
    .window-header {
      background: var(--win2k-window-header-bg);
      color: var(--win2k-window-header-text);
      padding: 8px 12px;
      font-weight: bold;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: move;
      user-select: none;
    }
    .window-header > span {
      pointer-events: none;
    }
    .window-close-btn {
      background: var(--win2k-gray-light);
      border: 2px solid var(--win2k-gray-dark);
      color: var(--win2k-blue);
      font-weight: bold;
      cursor: pointer;
      font-size: 16px;
      line-height: 1;
      padding: 0 6px;
      user-select: none;
      transition: background-color 0.2s ease, color 0.2s ease;
    }
    .window-close-btn:hover {
      background: var(--win2k-blue);
      color: var(--win2k-white);
      border-color: var(--win2k-white);
    }
    .window-content {
      flex: 1;
      background: white;
      padding: 8px;
      overflow: auto;
      font-family: Consolas, monospace;
      color: black;
    }

    .CodeMirror {
      height: 100% !important;
      font-size: 14px;
      font-family: Consolas, monospace;
    }

    ul {
      margin: 0; padding: 0;
      list-style: none;
      overflow-y: auto;
      height: 100%;
    }
    ul li {
      padding: 6px 8px;
      cursor: pointer;
      user-select: none;
    }
    ul li:hover {
      background-color: var(--win2k-gray-light);
      color: var(--win2k-blue);
    }
  </style>
</head>
<body>

  <div id="desktop">
    <div class="icon" id="app-code-editor" title="Code Editor">üìù<br>Code Editor</div>
    <div class="icon" id="app-file-explorer" title="File Explorer">üìÅ<br>File Explorer</div>
  </div>

  <div id="taskbar"></div>

  <div id="windows"></div>

  <!-- CodeMirror JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/javascript/javascript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/xml/xml.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/css/css.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/htmlmixed/htmlmixed.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/python/python.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/lua/lua.min.js"></script>

  <script>
    const desktop = document.getElementById('desktop');
    const windows = document.getElementById('windows');
    const taskbar = document.getElementById('taskbar');

    let zIndexCounter = 100;
    const openApps = new Map();

    function createWindow(id, title, contentCreator) {
      if (openApps.has(id)) {
        bringToFront(id);
        return;
      }

      const win = document.createElement('div');
      win.classList.add('window');
      win.id = id;
      win.style.zIndex = ++zIndexCounter;

      const header = document.createElement('div');
      header.className = 'window-header';

      const titleSpan = document.createElement('span');
      titleSpan.textContent = title;

      const closeBtn = document.createElement('button');
      closeBtn.className = 'window-close-btn';
      closeBtn.innerHTML = '&times;';
      closeBtn.onclick = () => closeApp(id);

      header.appendChild(titleSpan);
      header.appendChild(closeBtn);

      const content = document.createElement('div');
      content.className = 'window-content';

      contentCreator(content);

      win.appendChild(header);
      win.appendChild(content);
      document.body.appendChild(win);

      dragElement(win, header);

      addTaskbarButton(id, title);

      openApps.set(id, win);
    }

    function addTaskbarButton(id, title) {
      if (document.getElementById('taskbtn-' + id)) return;

      const btn = document.createElement('button');
      btn.className = 'taskbar-btn';
      btn.id = 'taskbtn-' + id;
      btn.textContent = title;

      const closeIcon = document.createElement('button');
      closeIcon.className = 'taskbar-close';
      closeIcon.innerHTML = '&times;';
      closeIcon.onclick = (e) => {
        e.stopPropagation();
        closeApp(id);
      };

      btn.appendChild(closeIcon);

      btn.onclick = () => {
        const win = document.getElementById(id);
        if (!win) return;

        if (win.style.display === 'none') {
          win.style.display = 'flex';
        }
        bringToFront(id);
      };

      taskbar.appendChild(btn);
    }

    function closeApp(id) {
      const win = document.getElementById(id);
      if (win) win.remove();

      const btn = document.getElementById('taskbtn-' + id);
      if (btn) btn.remove();

      openApps.delete(id);
    }

    function bringToFront(id) {
      const win = document.getElementById(id);
      if (!win) return;

      win.style.display = 'flex';
      win.style.zIndex = ++zIndexCounter;
    }

    function dragElement(elmnt, dragHandle) {
      let pos1 = 0,
        pos2 = 0,
        pos3 = 0,
        pos4 = 0;
      dragHandle.onmousedown = dragMouseDown;

      function dragMouseDown(e) {
        e.preventDefault();
        pos3 = e.clientX;
        pos4 = e.clientY;

        document.onmouseup = closeDragElement;
        document.onmousemove = elementDrag;
      }

      function elementDrag(e) {
        e.preventDefault();

        pos1 = pos3 - e.clientX;
        pos2 = pos4 - e.clientY;
        pos3 = e.clientX;
        pos4 = e.clientY;

        elmnt.style.top = elmnt.offsetTop - pos2 + 'px';
        elmnt.style.left = elmnt.offsetLeft - pos1 + 'px';
      }

      function closeDragElement() {
        document.onmouseup = null;
        document.onmousemove = null;
      }
    }

    // Code Editor content
    function createCodeEditorContent(container) {
      const textarea = document.createElement('textarea');
      textarea.id = 'code-editor-textarea';
      container.appendChild(textarea);

      const cmInstance = CodeMirror.fromTextArea(textarea, {
        lineNumbers: true,
        mode: 'javascript',
        theme: 'default',
        indentUnit: 2,
        tabSize: 2,
        autofocus: true,
      });

      const langSelector = document.createElement('select');
      langSelector.style.marginTop = '8px';
      langSelector.style.width = '100%';

      const modes = {
        JavaScript: 'javascript',
        HTML: 'htmlmixed',
        CSS: 'css',
        Python: 'python',
        Lua: 'lua',
        JSON: 'application/json',
      };

      for (const lang in modes) {
        const option = document.createElement('option');
        option.value = modes[lang];
        option.textContent = lang;
        langSelector.appendChild(option);
      }

      langSelector.onchange = () => {
        cmInstance.setOption('mode', langSelector.value);
      };

      container.appendChild(langSelector);
    }

    // File Explorer content
    function createFileExplorerContent(container) {
      const fileList = ['helper.py', 'README.md', 'notes.txt'];

      const ul = document.createElement('ul');
      ul.style.listStyle = 'none';
      ul.style.padding = '0';
      ul.style.margin = '0';
      ul.style.height = '100%';
      ul.style.overflowY = 'auto';

      fileList.forEach((file) => {
        const li = document.createElement('li');
        li.textContent = file;
        li.style.cursor = 'pointer';
        li.style.padding = '8px';
        li.style.borderBottom = '1px solid #ddd';

        li.onmouseenter = () => (li.style.backgroundColor = '#c0c0c0');
        li.onmouseleave = () => (li.style.backgroundColor = 'transparent');

        li.onclick = () => {
          if (file === 'helper.py') {
            openApp('codeEditor', 'Code Editor', createCodeEditorContent);
            setTimeout(() => {
              const cm = document.querySelector('.CodeMirror').CodeMirror;
              if (cm) {
                cm.setValue(`# helper.py example\nprint("Hello from helper.py!")`);
                cm.setOption('mode', 'python');
              }
            }, 200);
          } else {
            alert(`Pretend opening file: ${file}`);
          }
        };

        ul.appendChild(li);
      });

      container.appendChild(ul);
    }

    // Open apps & handle desktop icons
    function openApp(id, title, contentCreator) {
      if (openApps.has(id)) {
        bringToFront(id);
        return;
      }
      createWindow(id, title, contentCreator);
    }

    document.getElementById('app-code-editor').onclick = () =>
      openApp('codeEditor', 'Code Editor', createCodeEditorContent);

    document.getElementById('app-file-explorer').onclick = () =>
      openApp('fileExplorer', 'File Explorer', createFileExplorerContent);
  </script>
</body>
</html>
